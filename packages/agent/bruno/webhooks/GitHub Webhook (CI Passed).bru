meta {
  name: GitHub Webhook (CI Passed)
  type: http
  seq: 3
}

post {
  url: {{baseUrl}}/webhooks/github
  body: json
  auth: none
}

headers {
  X-GitHub-Event: check_suite
}

body:json {
  {
    "action": "completed",
    "check_suite": {
      "conclusion": "success",
      "head_branch": "agent/issue-42-add-login",
      "head_sha": "abc123",
      "pull_requests": [
        {
          "number": 99,
          "head": {
            "ref": "agent/issue-42-add-login"
          }
        }
      ]
    },
    "repository": {
      "full_name": "org/repo"
    }
  }
}

docs {
  ## GitHub Webhook (CI Passed)

  Simulates a GitHub `check_suite` webhook when CI passes on an issue branch.

  The reaction engine will:
  1. Match the branch to an active session
  2. Emit `session.ci_passed` event
  3. Transition the session from `waiting_ci` to `waiting_review`
}
